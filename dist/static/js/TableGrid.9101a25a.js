(window.webpackJsonp=window.webpackJsonp||[]).push([["TableGrid"],{"13c8":function(e,t,a){var n=a("c3a1"),i=a("36c3"),s=a("355d").f;e.exports=function(e){return function(t){for(var a,d=i(t),o=n(d),l=o.length,r=0,u=[];r<l;)s.call(d,a=o[r++])&&u.push(e?[a,d[a]]:d[a]);return u}}},"23b2":function(e,t,a){"use strict";var n=a("7e27");a.n(n).a},5176:function(e,t,a){e.exports=a("51b6")},"7d6d6":function(e,t,a){var n=a("63b6"),i=a("13c8")(!1);n(n.S,"Object",{values:function(e){return i(e)}})},"7e27":function(e,t,a){},"8e9b":function(e,t,a){"use strict";var n=a("90d0");a.n(n).a},"90d0":function(e,t,a){},"9e1c":function(e,t,a){a("7d6d6"),e.exports=a("584a").Object.values},db0c:function(e,t,a){e.exports=a("9e1c")},f0e4:function(e,t,a){"use strict";a.r(t);var n=a("f499"),i=a.n(n),s=(a("cadf"),a("551c"),a("097d"),a("db0c")),d=a.n(s),o=a("5176"),l=a.n(o),r=(a("c5f6"),a("ac6a"),{name:"inputedit",props:{editType:{type:String},options:{type:Array,default:function(){return[]}},data:{type:Object},columns:{type:Object}},data:function(){return{editRow:this.data}},methods:{handleChange:function(e){this.$emit("changeInput",this.editRow)}}}),u=(a("8e9b"),a("2877")),c=Object(u.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-input",{directives:[{name:"show",rawName:"v-show",value:"input"===e.editType,expression:"editType === 'input'"}],attrs:{maxlength:25,placeholder:"请输入内容"},on:{change:e.handleChange},model:{value:e.editRow[e.columns.property],callback:function(t){e.$set(e.editRow,e.columns.property,t)},expression:"editRow[columns.property]"}}),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"select"===e.editType,expression:"editType === 'select'"}],on:{change:e.handleChange},model:{value:e.editRow[e.columns.property],callback:function(t){e.$set(e.editRow,e.columns.property,t)},expression:"editRow[columns.property]"}},e._l(e.options,function(t,n){return a("Option",{key:n,attrs:{value:t.label}},[e._v("\n          "+e._s(t.value)+"\n      ")])}),1),a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:"date"===e.editType,expression:"editType === 'date'"}],attrs:{placeholder:"请选择日期",type:e.editType,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:e.handleChange},model:{value:e.editRow[e.columns.property],callback:function(t){e.$set(e.editRow,e.columns.property,t)},expression:"editRow[columns.property]"}}),a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:"year"===e.editType,expression:"editType === 'year'"}],attrs:{placeholder:"请选择年份",type:e.editType,format:"yyyy","value-format":"yyyy"},on:{change:e.handleChange},model:{value:e.editRow[e.columns.property],callback:function(t){e.$set(e.editRow,e.columns.property,t)},expression:"editRow[columns.property]"}}),a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:"month"===e.editType,expression:"editType === 'month'"}],attrs:{placeholder:"请选择年月",type:e.editType,format:"yyyy-MM","value-format":"yyyy-MM"},on:{change:e.handleChange},model:{value:e.editRow[e.columns.property],callback:function(t){e.$set(e.editRow,e.columns.property,t)},expression:"editRow[columns.property]"}})],1)},[],!1,null,"0ee645c1",null);c.options.__file="InputEdit.vue";var p={components:{InputEdit:c.exports},props:{showSummary:{type:Boolean,default:!1},tableData:{type:Array,required:!0},columns:{type:Array,required:!0},addInsideData:{type:Array,default:function(){return[]}},updateInsideData:{type:Array,default:function(){return[]}},deleteInsideData:{type:Array,default:function(){return[]}}},data:function(){return{tableInsideData:[],tableInsideColumns:[],editIndex:-1,editRow:{},isDisable:!1,isAddRow:!1,backupRow:{}}},methods:{summaryMethod:function(e){var t=e.columns,a=e.data,n=[];return t.forEach(function(e,t){if(0!==t){var i=a.map(function(t){return Number(t[e.property])});i.some(function(e){return isNaN(e)})?n[t]="":(n[t]=i.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0),n[t]=n[t].toFixed(2))}else n[t]="合计"}),n},iniTableColumns:function(){this.tableInsideColumns=this.columns.map(function(e,t){return e.columnKey=t,e})},startEdit:function(e,t,a){-1===this.editIndex?(this.editIndex=a,this.backupRow=l()({},e)):this.$message.warning({message:"请先保存或取消当前编辑数据",type:"warning"})},saveEdit:function(e,t,a){if(d()(e).every(function(e){return""!==e})){if(-1!==this.editIndex&&(this.tableData[a]=e),this.editIndex=-1,this.isAddRow&&(this.addInsideData.unshift(e),this.$emit("save-add",this.addInsideData),this.isAddRow=!1),e.id){var n=!1;this.updateInsideData.forEach(function(t){e.id===t.id&&(n=!0)}),n||(this.updateInsideData.unshift(e),this.$emit("save-update",this.updateInsideData))}else this.addInsideData.splice(-1,1,e),this.$emit("save-add",this.addInsideData);this.editRow={}}else this.$message.warning({type:"warning",message:"请填写内容"})},cancelEdit:function(e,t,a){this.isAddRow?(this.tableData.splice(0,1),this.addInsideData.splice(a,1),this.$emit("save-add",this.addInsideData),this.isAddRow=!1):this.tableData[a]=this.backupRow,this.backupRow={},this.editIndex=-1},deleteData:function(e,t,a){var n=this;this.$confirm("此操作将删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.tableData.splice(a,1),n.deleteInsideData.push(e),n.$emit("save-delete",n.deleteInsideData),n.$message({type:"success",message:"删除成功!"})})},handleChange:function(e){this.editRow=e},addRow:function(){-1===this.editIndex?(this.tableData.unshift(this.editRow),this.editIndex=0,this.isAddRow=!0):this.$message({message:"请先保存或取消当前编辑数据",type:"warning"})}},mounted:function(){this.iniTableColumns()}},h=(a("23b2"),Object(u.a)(p,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.tableData,"highlight-current-row":!0,"header-cell-style":{"background-color":"#f5f7fa"},"show-summary":e.showSummary,"summary-method":e.summaryMethod}},[e._l(e.tableInsideColumns,function(t,n){return a("el-table-column",{key:n,attrs:{label:t.label,prop:t.prop||"",width:t.width,align:t.align},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row,s=n.column,d=n.$index;return[e.editIndex!==d?a("span",[e._v(e._s(i[s.property]))]):a("div",[a("input-edit",{attrs:{editType:t.options,data:i,columns:s},on:{changeInput:e.handleChange}})],1)]}}])})}),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,i=t.column,s=t.$index;return[a("div",{directives:[{name:"show",rawName:"v-show",value:e.editIndex!==s,expression:"editIndex !== $index"}],staticClass:"handle"},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.startEdit(n,i,s)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.deleteData(n,i,s)}}},[e._v("删除")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.editIndex===s,expression:"editIndex === $index"}],staticClass:"handle"},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.saveEdit(n,i,s)}}},[e._v("保存")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.cancelEdit(n,i,s)}}},[e._v("取消")])],1)]}}])})],2),a("div",{staticClass:"add"},[a("el-button",{staticStyle:{width:"100%"},attrs:{icon:"el-icon-plus",disabled:e.isDisable},on:{click:e.addRow}},[e._v("添加")])],1)],1)},[],!1,null,"a2674806",null));h.options.__file="TableEdit.vue";var m={components:{TableEdit:h.exports},data:function(){return{options:[{label:"是",value:"是"},{label:"否",value:"否"}],columnsConfig:[{prop:"name",label:"借款银行名称",options:"input",align:"center"},{prop:"open",label:"授信额度(万元)",options:"input",align:"center"},{prop:"email",label:"借款金额（万元）",options:"input",align:"center"},{prop:"createTime",label:"起止日期",options:"date",align:"center"},{prop:"remark",label:"备注",options:"input",align:"center"}],tableData:[],dialogTableVisible:!1,addData:[],updateData:[],deleteData:[],loadingStatus:!1,fileList:[],fileUploadParam:{creditCode:sessionStorage.getItem("creditCode"),token:sessionStorage.getItem("token")},param:{creditCode:sessionStorage.getItem("creditCode"),token:sessionStorage.getItem("token")}}},mounted:function(){this.init()},methods:{saveAdd:function(e){this.addData=e},saveUpdate:function(e){this.updateData=e},saveDelete:function(e){this.deleteRow=e},eventData:function(e){this.fileList=e,this.getUploadGsjkqk()},init:function(){this.getGsjkqk()},getGsjkqk:function(){var e=this;this.$http({url:"/user/edit",method:"post"}).then(function(t){0===t.data.errno&&(e.tableData=t.data.data)}).catch(function(e){})},changeInput:function(e){var t=e.index,a=e.tmpProp;this.tableData[t][a]=e.change},cancelRow:function(e,t,a){var n=this;n.editIndex=null,n.isAddRow?n.tableData.splice(0,1):(n.tableData.splice(e,1,n.backupsRow),n.backupsRow.id?n.updateData.splice(e,1,n.backupsRow):n.addData.splice(e,1,n.backupsRow)),n.editRow={},n.backupsRow={}},editStatus:function(e,t){var a=this;a.isAddRow?(a.tableData.splice(0,1,a.editRow),a.addData.unshift(t)):t.id&&a.updateData.unshift(t),a.editIndex=null,a.backupsRow={},a.editRow={}},saveRow:function(e,t,a){var n=this;if(null!==n.editIndex){if(""===t.jkyhmc||null==t.jkyhmc||void 0===t.jkyhmc)return this.$message({message:"请填写借款银行名称",type:"warning"}),null;if(""===t.sxed||null===t.sxed||void 0===t.sxed)return this.$message({message:"请填写授信额度",type:"warning"}),null;if(!/^[1-9]\d*\d*|[1-9]\d*$/.test(t.sxed))return this.$message({message:"授信额度需录入正确格式",type:"warning"}),null;if(""===t.jkje||null===t.jkje||void 0===t.jkje)return this.$message({message:"请填写借款金额",type:"warning"}),null;if(!/^[1-9]\d*\d*|[1-9]\d*$/.test(t.jkje))return this.$message({message:"借款金额需录入正确格式",type:"warning"}),null;if(n.editIndex!==e)return this.$message({message:"请先保存或取消当前编辑数据",type:"warning"}),null;n.editStatus(e,t)}else n.editIndex=e,n.editRow=t,n.tempRow=JSON.parse(i()(t)),n.backupsRow=JSON.parse(i()(t));this.isAddRow=!1},addRow:function(){null===this.editIndex?(this.tableData.unshift(this.editRow),this.editIndex=0,this.isAddRow=!0):this.$message({message:"请先保存或取消当前编辑数据",type:"warning"})},save:function(){var e=this;if(null==this.editIndex){this.loadingStatus=!0;var t={creditCode:sessionStorage.getItem("creditCode"),addData:i()(this.addData),updateData:i()(this.updateData),delData:i()(this.deleteData)};this.$axios.post("/qiugu/test",t).then(function(t){var a=t.data;"0"===a.resultCode?(e.$message({message:a.resultMsg,type:"success"}),e.getGsjkqk()):e.$message({message:a.resultMsg,type:"error"})}),this.loadingStatus=!1,this.addData=[],this.updateData=[],this.deleteData=[]}else this.$message({message:"请先保存或取消当前编辑数据",type:"warning"})},deleteRow:function(e,t){var a=this;null===this.editIndex?this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.tableData.splice(e,1),a.addData.splice(e,1),t.id&&a.deleteData.push(t)}):this.$message({message:"请先保存或取消当前编辑数据",type:"warning"})}}},f=Object(u.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("el-card",{staticClass:"box-card"},[a("table-edit",{attrs:{tableData:e.tableData,columns:e.columnsConfig,showSummary:!0,options:"options",addInsideData:e.addData,updateInsideData:e.updateData,deleteInsideData:e.deleteData},on:{"save-add":e.saveAdd,"save-update":e.saveUpdate,"save-delete":e.saveDelete}})],1)],1)},[],!1,null,"43702af2",null);f.options.__file="TableGrid.vue",t.default=f.exports}}]);